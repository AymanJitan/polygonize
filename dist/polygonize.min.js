"use strict";!function(e){e.Polygonize=function(n){function r(e,n){return parseInt(Math.floor(Math.random()*(n-e+1)+e))}function t(e){var n=e.toString(16);return 1===n.length?"0"+n:n}function a(e,n,r){return"#"+t(e)+t(n)+t(r)}function i(e,n){var r=u.canvas.getContext("2d").getImageData(e,n,1,1).data;if(0!==r[3])return a(r[0],r[1],r[2])}function l(e,r){var t=parseInt((e+1)/r*100);t!==v&&(v=t,n.progress&&n.progress(v))}function o(e,n,r){r.beginPath(),r.moveTo(e[0][0],e[0][1]),r.lineTo(e[1][0],e[1][1]),r.lineTo(e[2][0],e[2][1]),r.fillStyle=n,r.strokeStyle=n,r.fill(),r.stroke()}function c(){var e=document.createElement("canvas"),t=e.getContext("2d");u.canvas=document.createElement("canvas");var a=[],c=parseInt(u.width),s=parseInt(u.height);u.canvas.width=c,u.canvas.height=s,u.canvas.getContext("2d").drawImage(u,0,0,c,s),e.width=c,e.height=s;for(var v=parseInt(c/n.cellSize),g=parseInt(s/n.cellSize),f={x:-n.cellSize,y:-n.cellSize},h={x:(v+1)*n.cellSize,y:(g+1)*n.cellSize},S=f.x;S<=h.x;S+=n.cellSize)for(var d=f.y;d<=h.y;d+=n.cellSize){var z={x:r(S,S+n.cellSize),y:r(d,d+n.cellSize)};a.push([z.x,z.y])}for(var y=Delaunay.triangulate(a),p=0;p<y.length;p+=3){var w=[y[p],y[p+1],y[p+2]].map(function(e){return a[e]}),m=parseInt((w[0][0]+w[1][0]+w[2][0])/3),I=parseInt((w[0][1]+w[1][1]+w[2][1])/3),x=i(m,I)||i(w[0][0],w[0][1])||i(w[1][0],w[1][1])||i(w[2][0],w[2][1]);o(w,x,t),l(p,y.length-3)}return e}if(!e.Delaunay)throw new Error("Polygonize's JavaScript requires Delaunay (https://github.com/ironwallaby/delaunay)");if(!n.src)throw new Error("Image source is undefined");var s={cellSize:10};n.cellSize=n.cellSize||s.cellSize;var u=new Image;u.src=n.src;var v=0;u.onload=function(){var e=c();n.onSuccess&&n.onSuccess(e)},u.onerror=function(){throw new Error("Invalid image source")}}}(window);